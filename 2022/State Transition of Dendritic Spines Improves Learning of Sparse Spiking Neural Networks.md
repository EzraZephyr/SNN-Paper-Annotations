
## State Transition of Dendritic Spines Improves Learning of Sparse Spiking Neural Networks

[论文链接](https://proceedings.mlr.press/v162/chen22ac.html)

模拟树突棘的SNN

首先这个模型是基于基础的LIF模型进行实现的 参考公式1到3

使用软阈值 参考公式4 如果θ 即树突棘的大小 用于判断其状态 使用正截取操作 (|θ| - d)+ 可以理解为
如果|θ| - d > 0 取|θ| - d 表示处于成熟的树突棘状态
否则取0 则证明该突触棘处于丝状伪足状态还不足以形成连接 权重不存在
sign为符号函数 作为兴奋性和抑制性突触之间的转换

公式5定义了θ的梯度 使用w作为中间变量使L间接依赖于θ 计算θL 因为是SNN计算 会涉及到阶跃函数无法求导的问题 使用替代梯度进行近似

关于稀疏性如何被诱导 首先为公式7 形似公式4 为逐元素软阈值运算符
公式8 为根据公式4和5推导出来的梯度表达式 其中diag()内的内容作为一个指示向量 如果|θt-1|>1则为树突棘成熟 为1 否则为0
随后使用梯度下降的更新规则对新时间步t的θ进行更新 公式9 η为学习率 后者可以很好的模拟树突棘

然后计算中间权重w 公式10 此时中间权重依赖的是上一个时间步的阈值dt-1(还未在此时间步更新) 和刚刚经历过梯度下降的树突棘大小θt
而最终权重 公式11是依赖根据调度器决定的新的时间步的dt 具体查看后面的4.4 再对权重进行一下收缩使得更多权重变为0 其中注意的是dt - dt-1 >0 关于为什么要分离：第一是为了拟合生物学特性 用中间变量w实现树突棘的过渡阶段 第二是为了作者在后续分析变化情况以分离细节 具体查看case1,case2,case3

假设θt-1大于dt-1 根据公式10得到公式12

case1: 相同符号和非零权重 梯度更新后符号不变 且权重存在 则可以表明sign(θt) = sign(θt-1) 并且|θt|和|θt-1|均大于d 这种情况发生在梯度更新步长较小的情况下 将公式12应用公式7进行展开 又因为前后时间步符号相同且均大于d 可通过公式4化简为公式13 带回公式11得到最终的Wt权重方程为公式14 这个权重的迭代更新公式和ISTA优化的迭代公式一样 证明了其优化过程有依据 并且可以很好的实现稀疏化 因为ISTA优化算法就是设计被用来进行稀疏优化的

case2: 不同符号和非零权重 梯度更新后符号反转sign(θt)dt-1和sign(θt-1)d-1不同 这导致产生了双倍的阈值偏差 所以要减去 参考公式16 计算完的式子像case1一样重新带入计算最终的权重wt 就为在不同符号下的梯度更新公式

case3: 权重为0的情况 即θ处在d到-d之间 这个情况下将使得w恒定为0 导数自然也为0 但这也就会导致无法使用梯度下降进行恢复 导致此分支完全死亡 不符合树突棘的重新生长机制 所以这里手动将w/θ的导数设置为1 这样即使处于d到-d之间权重为0 即丝状伪足 还是可以继续生长以模拟突触棘的生物学机制

4.1用作证明这个网络可以收敛 损失函数一定会趋向一个稳定值
4.4关于d的行为分析为两种调度器 一种是线性的一种是正弦的 具体差异解释在experiment中

experiment省略