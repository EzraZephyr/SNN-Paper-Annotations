
## SEENN: Towards Temporal Spiking Early-Exit Neural Networks

[论文链接](https://openreview.net/pdf?id=mbaN0Y0QTw)

提出了一种早退方法SEENN 可以在很低的时间步例如T=2.228达到正常需要6个时间步的准确率

神经元方面使用的还是经典的LIF神经元 参考公式1 2 其中τ为泄露因子 在直接训练的情况下使用τ=0.5 转换的时候为τ=1.0变为无泄漏的IF s为发放的脉冲 用一个阶跃函数控制

公式3展示了LIF前向传播的表述 其中g为骨干网络 h为分类器 在T个时间步内重复计算 然后取平均值输出

3.2
从图1中的第一个图可以看出 时间步从2到6 只增加了0.34%的准确率 但是延迟却增加了300% 所以大多数的正确的预测都可以集中在前面的1-2个时间步 所以作者提出了一个想法 根据图的复杂程度不同来决定应该使用多少的时间步

这里作者提出了一个假设 如果在t个时间步可以预测正确x 那么存在一个任意的t\` 满足 t<=t`<=T 总是能做出正确的预测 Ct为在时间步t内正确预测的输入样本的集合 根据这个假设 可以有C1 ⊆ C2 ⊆ ... ⊆ CT 提出了一个AET指标 描述了一个理想的场景 即每个样本都是用最少的时间步进行推理 结果和T的准确性保持相同 参考公式4 总样本数为N C1为第一个时间步内预测正确的有样本 W为N中在T个时间步依旧错误的集合 ∑内代表在第t-1个时间步没有被正确预测 但是在t个时间步被正确预测的集合 在图1中 参考原文 在CIFAR10中 这样计算出来的结果为2.228 即用2.228个时间步就可以达到6个时间步的准确性

作者在附录A中进行了证明 参考公式13 其中t^i是第i个实际样本预测正确时的最早时间步数 进行反推 根据表5可以看出 其差异非常小 通常小于0.05 唯一差异较大的CIFAR10-DVS的原因是因为事件流数据集会在时间上提供更多变化。

但是在实践中AET是使用不了的 因为无法访问真实的测试集标签 所以作者提出了两种方法SEENN-I 和 SEENN-II

3.3
SEENN-I 用置信度分数来解决 第t个时间步的网络输入为ft(x) 通过softmax转换为一个概率分布 P = softmax(ft(x)) = [p1, p2, ..., pM] M为目标类别的数量 所以置信度分数为公式5 提取出最可能的类别的置信度 假设CS = 0.99 那么预测的分布基本可以被确定 否则例如1/M 将会是一个均匀且极不确定的值  且这个不确定性的水平和神经网络的准确性高度相关 所以可以用这个作为一个指标来分配时间步 图2a

所以这里设定一个阈值α 从t=1开始 如果CSt>α 那么将直接取此时间步作为最终预测结果 否则继续到下一个时间步 如果到T个时间步也没有超过阈值α的则正常输出 但是这种是一种后训练的方法 通过手动定义一个阈值 可能无法找到最佳的退出时间步

3.4
SEENN-II 用一种强化学习的思路解决 图2b 首先定义一个动作空间T ≡ {t1, t2, ... ,tn} 目标是选择一个最优的t 作者设计了一个策略网络 生成一个n维策略向量来采样动作 参考公式6 其中x为输入 θ为参数 输出一个n维向量经过softmax变为分类分布的概率 通过对每个分类v进行累乘 其中Zk为选择的时间步Z的第k个分量 为一个二值01 这样可以计算出选择某个时间步的概率 比如说z = [0,0,1,0] 那么只有第三个分量为1一次方 其余输出都是1 那么就可以得到ti时间步的一个概率 然后就可以对目标时间不进行预测 使用一个奖励函数 公式7 如果是正确的 t的时间步越小奖励越大 越大奖励成指数减小 这个β的乘法和奖励形成一种平衡 如果错误的惩罚项大 比如说为一个正整数 那么会比奖励大得多 网络就会为了提高准确性而牺牲时间步 反之将会选择时间步最少但是准确性没有特别高的

训练目标就是最大化这个期望奖励函数z 定义为公式8 并用策略梯度方关于θ计算导数 公式9 因为蒙特卡洛采样需要多次采样z 进行R(z) 成本比较高 而SEENN-II在每个tk中储存了中间累积输出 所以可以将公式9重写为公式10

3.5
训练SEENN-I 在每个时间步都添加一个交叉熵函数LCE以衡量差异并最后去平均 公式11 这是一种TET损失 和只对最大的步数用交叉熵函数 这样能提升每个tk的性能 然后如果是ANN2SNN的话 这里直接用置信度阈值了不用修改函数

训练SEENN-II 先使用刚才I的TET训练若干轮 如果通过公式11的方式联合优化 其中-R(z)的意思是最小化R(z)相当于最大化R(z)和上面相符 注意 SEENN-II不适用于ANN2SNN

experiments省略
